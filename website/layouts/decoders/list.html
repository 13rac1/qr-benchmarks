{{ define "main" }}
<h1>Decoder Rankings</h1>

<p>Decoders are ranked by overall success rate across all encoder combinations and test conditions.</p>

<table>
  <thead>
    <tr>
      <th>Rank</th>
      <th>Decoder</th>
      <th>Success Rate</th>
      <th>Avg Decode Time</th>
      <th>Successes</th>
      <th>Tests</th>
      <th>Skips</th>
    </tr>
  </thead>
  <tbody>
    {{ range $i, $d := .Site.Data.decoders }}
    <tr>
      <td>{{ add $i 1 }}</td>
      <td><strong><a href="https://github.com/{{ .name }}" target="_blank" rel="noopener noreferrer">{{ .name }}</a></strong></td>
      <td class="{{ if ge .successRate 95.0 }}rate-high{{ else if ge .successRate 80.0 }}rate-medium{{ else }}rate-low{{ end }}">
        {{ printf "%.1f%%" .successRate }}
      </td>
      <td>{{ printf "%.2fms" .avgDecodeMs }}</td>
      <td>{{ .successCount }}</td>
      <td>{{ .effectiveTests }}</td>
      <td>{{ .capacitySkips }}</td>
    </tr>
    {{ end }}
  </tbody>
</table>

<h2>Per-Encoder Breakdown</h2>

{{ range $d := .Site.Data.decoders }}
<h3><a href="https://github.com/{{ .name }}" target="_blank" rel="noopener noreferrer">{{ .name }}</a></h3>

<h4>By Encoder</h4>
<table>
  <thead>
    <tr>
      <th>Encoder</th>
      <th>Success Rate</th>
      <th>Successes</th>
      <th>Tests</th>
      <th>Skips</th>
    </tr>
  </thead>
  <tbody>
    {{ range $enc, $stats := .byEncoder }}
    <tr>
      <td><a href="https://github.com/{{ $enc }}" target="_blank" rel="noopener noreferrer">{{ $enc }}</a></td>
      <td class="{{ if ge $stats.successRate 95.0 }}rate-high{{ else if ge $stats.successRate 80.0 }}rate-medium{{ else }}rate-low{{ end }}">
        {{ printf "%.1f%%" $stats.successRate }}
      </td>
      <td>{{ $stats.successes }}</td>
      <td>{{ $stats.effectiveTests }}</td>
      <td>{{ $stats.capacitySkips }}</td>
    </tr>
    {{ end }}
  </tbody>
</table>

<h4>By Error Correction Level</h4>
<table>
  <thead>
    <tr>
      <th>EC Level</th>
      <th>Success Rate</th>
      <th>Avg Decode Time</th>
      <th>Successes</th>
      <th>Tests</th>
      <th>Skips</th>
    </tr>
  </thead>
  <tbody>
    {{ range $ec, $stats := .byErrorCorrection }}
    <tr>
      <td><strong>{{ $stats.level }}</strong></td>
      <td class="{{ if ge $stats.successRate 95.0 }}rate-high{{ else if ge $stats.successRate 80.0 }}rate-medium{{ else }}rate-low{{ end }}">
        {{ printf "%.1f%%" $stats.successRate }}
      </td>
      <td>{{ printf "%.2fms" $stats.avgTimeMs }}</td>
      <td>{{ $stats.successCount }}</td>
      <td>{{ $stats.effectiveTests }}</td>
      <td>{{ $stats.capacitySkips }}</td>
    </tr>
    {{ end }}
  </tbody>
</table>
{{ end }}
{{ end }}
