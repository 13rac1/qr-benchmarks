{{ define "main" }}
<h1>Encoder Rankings</h1>

<p>Encoders are ranked by overall success rate across all decoder combinations and test conditions.</p>

<table>
  <thead>
    <tr>
      <th>Rank</th>
      <th>Encoder</th>
      <th>Success Rate</th>
      <th>Avg Encode Time</th>
      <th>Successes</th>
      <th>Tests</th>
      <th>Skips</th>
    </tr>
  </thead>
  <tbody>
    {{ range $i, $e := .Site.Data.encoders }}
    <tr>
      <td>{{ add $i 1 }}</td>
      <td><strong><a href="https://github.com/{{ .name }}" target="_blank" rel="noopener noreferrer">{{ .name }}</a></strong></td>
      <td class="{{ if ge .successRate 95.0 }}rate-high{{ else if ge .successRate 80.0 }}rate-medium{{ else }}rate-low{{ end }}">
        {{ printf "%.1f%%" .successRate }}
      </td>
      <td>{{ printf "%.2fms" .avgEncodeMs }}</td>
      <td>{{ .successCount }}</td>
      <td>{{ .effectiveTests }}</td>
      <td>{{ .capacitySkips }}</td>
    </tr>
    {{ end }}
  </tbody>
</table>

<h2>Per-Decoder Breakdown</h2>

{{ range $e := .Site.Data.encoders }}
<h3><a href="https://github.com/{{ .name }}" target="_blank" rel="noopener noreferrer">{{ .name }}</a></h3>
<table>
  <thead>
    <tr>
      <th>Decoder</th>
      <th>Success Rate</th>
      <th>Successes</th>
      <th>Tests</th>
      <th>Skips</th>
    </tr>
  </thead>
  <tbody>
    {{ range $dec, $stats := .byDecoder }}
    <tr>
      <td><a href="https://github.com/{{ $dec }}" target="_blank" rel="noopener noreferrer">{{ $dec }}</a></td>
      <td class="{{ if ge $stats.successRate 95.0 }}rate-high{{ else if ge $stats.successRate 80.0 }}rate-medium{{ else }}rate-low{{ end }}">
        {{ printf "%.1f%%" $stats.successRate }}
      </td>
      <td>{{ $stats.successes }}</td>
      <td>{{ $stats.effectiveTests }}</td>
      <td>{{ $stats.capacitySkips }}</td>
    </tr>
    {{ end }}
  </tbody>
</table>
{{ end }}
{{ end }}
