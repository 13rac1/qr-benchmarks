{{ define "main" }}
<h1>QR Library Benchmark Results</h1>

{{ with .Site.Data.summary }}
<div class="summary-cards">
  <div class="card">
    <h3>Effective Tests</h3>
    <div class="value">{{ .effectiveTests }}</div>
    <div class="subtext">{{ .capacitySkips }} capacity skips</div>
  </div>
  <div class="card">
    <h3>Success Rate</h3>
    <div class="value {{ if ge .overallRate 95.0 }}success{{ else if ge .overallRate 80.0 }}warning{{ else }}danger{{ end }}">
      {{ printf "%.1f%%" .overallRate }}
    </div>
  </div>
  <div class="card">
    <h3>Encoders</h3>
    <div class="value">{{ .encoderCount }}</div>
  </div>
  <div class="card">
    <h3>Decoders</h3>
    <div class="value">{{ .decoderCount }}</div>
  </div>
</div>

<h2>Winners</h2>
<div class="summary-cards">
  <div class="card winner">
    <h3>Best Encoder</h3>
    <div class="value">{{ .bestEncoder }}</div>
  </div>
  <div class="card winner">
    <h3>Best Decoder</h3>
    <div class="value">{{ .bestDecoder }}</div>
  </div>
  <div class="card winner">
    <h3>Best Combination</h3>
    <div class="value">{{ .bestCombination.encoder }} + {{ .bestCombination.decoder }}</div>
    <div>{{ printf "%.1f%%" .bestCombination.successRate }} success</div>
  </div>
</div>
{{ end }}

<h2>Encoder Rankings</h2>
<table>
  <thead>
    <tr>
      <th>Rank</th>
      <th>Encoder</th>
      <th>Success Rate</th>
      <th>Avg Encode Time</th>
      <th>Tests</th>
      <th>Skips</th>
    </tr>
  </thead>
  <tbody>
    {{ range $i, $e := .Site.Data.encoders }}
    <tr>
      <td>{{ add $i 1 }}</td>
      <td>{{ .name }}</td>
      <td class="{{ if ge .successRate 95.0 }}rate-high{{ else if ge .successRate 80.0 }}rate-medium{{ else }}rate-low{{ end }}">
        {{ printf "%.1f%%" .successRate }}
      </td>
      <td>{{ printf "%.2fms" .avgEncodeMs }}</td>
      <td>{{ .effectiveTests }}</td>
      <td>{{ .capacitySkips }}</td>
    </tr>
    {{ end }}
  </tbody>
</table>

<h2>Decoder Rankings</h2>
<table>
  <thead>
    <tr>
      <th>Rank</th>
      <th>Decoder</th>
      <th>Success Rate</th>
      <th>Avg Decode Time</th>
      <th>Tests</th>
      <th>Skips</th>
    </tr>
  </thead>
  <tbody>
    {{ range $i, $d := .Site.Data.decoders }}
    <tr>
      <td>{{ add $i 1 }}</td>
      <td>{{ .name }}</td>
      <td class="{{ if ge .successRate 95.0 }}rate-high{{ else if ge .successRate 80.0 }}rate-medium{{ else }}rate-low{{ end }}">
        {{ printf "%.1f%%" .successRate }}
      </td>
      <td>{{ printf "%.2fms" .avgDecodeMs }}</td>
      <td>{{ .effectiveTests }}</td>
      <td>{{ .capacitySkips }}</td>
    </tr>
    {{ end }}
  </tbody>
</table>

<p><a href="{{ "matrix/" | relURL }}">View full compatibility matrix &rarr;</a></p>
<p><a href="{{ "failures/" | relURL }}">View failure analysis &rarr;</a></p>
{{ end }}
